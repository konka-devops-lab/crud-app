server:
  log_level: info
  http_listen_port: 12345

metrics:
  global:
    scrape_interval: 15s
    external_labels:
      cluster: 'crud-app-cluster'
      environment: '${ENVIRONMENT:-development}'

  configs:
    - name: crud-app
      scrape_configs:
        - job_name: 'crud-app-metrics'
          static_configs:
            - targets: ['localhost:8080']
          metrics_path: '/actuator/prometheus'
          scrape_interval: 10s
          
        - job_name: 'crud-app-health'
          static_configs:
            - targets: ['localhost:8080']
          metrics_path: '/actuator/health'
          scrape_interval: 30s

      remote_write:
        - url: http://prometheus:9090/api/v1/write
          queue_config:
            max_samples_per_send: 1000
            max_shards: 200
            capacity: 2500

logs:
  configs:
    - name: crud-app-logs
      clients:
        - url: http://loki:3100/loki/api/v1/push
      positions:
        filename: /tmp/positions.yaml
      scrape_configs:
        - job_name: crud-app
          static_configs:
            - targets:
                - localhost
              labels:
                job: crud-app
                __path__: /app/logs/application.log
          pipeline_stages:
            - json:
                expressions:
                  timestamp: timestamp
                  level: level
                  logger: loggerName
                  message: message
                  application: application
                  environment: environment
            - labels:
                level:
                logger:
                application:
                environment: